<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Steve Slade" />
  <meta name="keywords" content="datalayer, javascrip, implementation, GTM, help" />
  <title>Implementation Guide | datalayer.js</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Implementation Guide | datalayer.js</h1>
<p class="author">Steve Slade</p>
</header>
<h1 id="datalayer.js-implementation-guide">datalayer.js Implementation Guide</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#javascript-versions">Javascript Versions</a></li>
<li><a href="#the-master-jf-object">The master JF Object</a></li>
<li><a href="#globally-accessible-store-of-data">Globally accessible store of data</a>
<ul>
<li><a href="#window.eventtracking">window.eventTracking</a></li>
</ul></li>
<li><a href="#custom-html-attributes">Custom HTML attributes</a></li>
<li><a href="#configuring-your-html-to-track-events">Configuring your HTML to track events</a>
<ul>
<li><a href="#js-trackevent">.js-trackEvent</a></li>
<li><a href="#js-trackitem">.js-trackItem</a></li>
<li><a href="#js-trackclick">.js-trackClick</a></li>
<li><a href="#data-gtm-event">data-gtm-event</a></li>
<li><a href="#data-gtm-type">data-gtm-type</a></li>
<li><a href="#data-gtm-track">data-gtm-track</a></li>
</ul></li>
<li><a href="#event-types">Event Types</a>
<ul>
<li><a href="#passive-event-tracking">‘Passive’ Event tracking</a></li>
<li><a href="#active-event-tracking">‘Active’ Event tracking</a></li>
</ul></li>
<li><a href="#event-triggers">Event triggers</a>
<ul>
<li><a href="#productimpression-promotionview">productImpression &amp; promotionView</a></li>
<li><a href="#productdetail-checkout">productDetail &amp; checkout</a></li>
<li><a href="#purchase">purchase</a></li>
<li><a href="#productclick-promotionclick">productClick &amp; promotionClick</a></li>
<li><a href="#addtocart-removefromcart">addToCart &amp; removeFromCart</a></li>
<li><a href="#manually-triggering-a-cart-update-event">Manually triggering a cart update event</a></li>
</ul></li>
</ul>
<h2 id="javascript-versions">Javascript Versions</h2>
<p>This code ships with two versions.</p>
<ul>
<li><code>datalayer.js</code> =&gt; The raw es6 base file that is used in all of the examples and is the standard.</li>
<li><code>datalayer_es5.js</code> =&gt; A Babel compiled es5 compatible version of the script.</li>
</ul>
<h2 id="the-master-jf-object">The master JF Object</h2>
<p>All of the main logic for the tracking is stored within a namespaced object <code>JF</code> at the top of this object are some classes that are set as default tracking classes, however if these cause conflicts with your code you are free to change them. Just make sure to update your mark up to match.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Instantiating the logic</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> JF <span class="op">=</span> <span class="kw">new</span> <span class="fu">JFdataLayer</span>()<span class="op">;</span></span></code></pre></div>
<p>You are also able to pass in some parameters if you choose. These parameters are contained within an <code>object</code> and allow you to set your own custom classes and to enable helpful logging code.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dafault properties and object structure</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>classes<span class="op">:</span> {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">events</span><span class="op">:</span>      <span class="st">&#39;js-trackEvent&#39;</span><span class="op">,</span>   <span class="co">// Event tracking class</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">items</span><span class="op">:</span>       <span class="st">&#39;js-trackItem&#39;</span><span class="op">,</span>    <span class="co">// Item (product, promotions) tracking class</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">clicks</span><span class="op">:</span>      <span class="st">&#39;js-trackClick&#39;</span><span class="op">,</span>   <span class="co">// Click trigger class</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">quantity</span><span class="op">:</span>    <span class="st">&#39;js-trackQuantity&#39;</span> <span class="co">// Used to determine inputs for cart tracking  </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>logging<span class="op">:</span> <span class="kw">false</span> <span class="co">// Whether or not to enable custom logging</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Defining custom classes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>classes<span class="op">:</span> {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> JF <span class="op">=</span> <span class="kw">new</span> <span class="fu">JFdataLayer</span>({</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">events</span><span class="op">:</span>      <span class="st">&#39;foo&#39;</span><span class="op">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">items</span><span class="op">:</span>       <span class="st">&#39;bar&#39;</span><span class="op">,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">clicks</span><span class="op">:</span>      <span class="st">&#39;baz&#39;</span><span class="op">,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">quantity</span><span class="op">:</span>    <span class="st">&#39;qux&#39;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Enabling logging code</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> JF <span class="op">=</span> <span class="kw">new</span> <span class="fu">JFdataLayer</span>({<span class="dt">logging</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span></code></pre></div>
<h2 id="globally-accessible-store-of-data">Globally accessible store of data</h2>
<p>All of the data that is tracked via this custom code is retrievable on the <code>window</code> object by accessing <code>window.eventTracking</code>.</p>
<h3 id="window.eventtracking">window.eventTracking</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Input</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">eventTracking</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Console output</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">data</span><span class="op">:</span> {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">event</span><span class="op">:</span> <span class="st">&quot;productImpression&quot;</span><span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">category</span><span class="op">:</span> <span class="st">&quot;EE Funnel&quot;</span><span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">action</span><span class="op">:</span> <span class="st">&quot;Impresion Producto&quot;</span><span class="op">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">&quot;Teléfonos&quot;</span><span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">currencycode</span><span class="op">:</span> <span class="st">&quot;GTQ&quot;</span><span class="op">,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    …</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">element</span><span class="op">:</span> div<span class="op">.</span><span class="at">item</span><span class="op">-</span>list<span class="op">.</span><span class="at">js</span><span class="op">-</span>trackEvent</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">products</span><span class="op">:</span> (<span class="dv">3</span>) [{…}<span class="op">,</span> {…}<span class="op">,</span> {…}]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">promotions</span><span class="op">:</span> []</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">viewedProducts</span><span class="op">:</span> [{…}]</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">viewedPromotions</span><span class="op">:</span> []</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="custom-html-attributes">Custom HTML attributes</h2>
<p>All tracking data is read from the DOM using custom data attributes. These will need to be defined and populated by your CMS solution. A custom class is also needed to define which type of data is referenced on the DOM elements.</p>
<blockquote>
<p><strong>Note:</strong> Custom attributes follow the format <code>data-foo-bar</code> and are converted to camelCased properties in JavaScript: <code>data-fooBar</code>. To ensure limited crossover with other custom attributes, the values we are using are namespaced in the DOM with the prefix <code>gtm-</code>. These are then manipulated in the script for ease of use.</p>
</blockquote>
<h2 id="configuring-your-html-to-track-events">Configuring your HTML to track events</h2>
<p>To begin tracking events, you will need to add the <code>js-trackEvent</code> class to wrapper elements that you wish to track along with the <code>data-gtm-event="…"</code> data attribute.</p>
<h3 id="js-trackevent">.js-trackEvent</h3>
<p>The JavaScript looks for the <code>js-trackEvent</code> class and then reads custom attributes included on the related DOM element to build the event data. You are able to provide whichever custom attributes you like to as long as they follow the namespace rule below.</p>
<h3 id="data-gtm-event">data-gtm-event</h3>
<p>Events tracked through the attribute <code>data-gtm-event</code>:</p>
<ul>
<li><code>productImpression</code></li>
<li><code>promotionView</code></li>
<li><code>productDetail</code></li>
<li><code>checkout</code></li>
<li><code>purchase</code></li>
</ul>
<p>All events that do not require user interaction should be wrapped with the <code>js-trackEvent</code> class and <code>data-gtm-event</code> attribute.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;productImpression&#39; event example</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;productImpression&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-category=</span><span class="st">&quot;EE Funnel&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-action=</span><span class="st">&quot;Impresion Producto&quot;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-label=</span><span class="st">&quot;Teléfonos&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-currency-code=</span><span class="st">&quot;GTQ&quot;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-list=</span><span class="st">&quot;New phones 2021&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="er">…</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> It is important to keep in mind that the event tracking class should be considered as a wrapper to other DOM elements on the page that would also be tracked. For example a <code>productImpression</code> event would not track anything if it doesn’t wrap any ‘products’.</p>
</blockquote>
<h3 id="js-trackitem">.js-trackItem</h3>
<p>To begin tracking items within events or items for click tracking, you will need to add the <code>js-trackItem</code> class along with the <code>data-gtm-type="…"</code> data attribute to elements that you wish to track in this way.</p>
<p>The JavaScript looks for the <code>js-trackItem</code> class and then reads custom attributes included on the related DOM element to build the event data. These items are more strictly typed so there are limitations on the data you can provide.</p>
<h3 id="data-gtm-type">data-gtm-type</h3>
<p>Items tracked through the attribute <code>data-gtm-type</code> must have a value of + <code>products</code> or + <code>promotions</code></p>
<h4 id="data-gtm-typeproducts">data-gtm-type=“products”</h4>
<p>Products are items that a user may which to view or purchase. They are not limited to physical items.</p>
<ul>
<li><code>data-gtm-name</code></li>
<li><code>data-gtm-id</code></li>
<li><code>data-gtm-price</code></li>
<li><code>data-gtm-brand</code></li>
<li><code>data-gtm-category</code></li>
<li><code>data-gtm-variant</code></li>
<li><code>data-gtm-list</code></li>
<li><code>data-gtm-position</code></li>
<li><code>data-gtm-quantity</code></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;productImpression&#39; event example</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The event --&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;productImpression&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- The item --&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackItem&quot;</span><span class="ot"> data-gtm-type=</span><span class="st">&quot;products&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-name=</span><span class="st">&quot;Iphone 1&quot;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-id=</span><span class="st">&quot;123&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-price=</span><span class="st">&quot;22.99&quot;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-brand=</span><span class="st">&quot;Apple&quot;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-category=</span><span class="st">&quot;Teléfonos&quot;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-variant=</span><span class="st">&quot;Black&quot;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-position=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="er">…</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&gt;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  …</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/div&gt;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h4 id="data-gtm-typepromotions">data-gtm-type=“promotions”</h4>
<p>Promotions are materials such as banner images, advertorials or any other marketing designed to drive users to a product.</p>
<ul>
<li><code>data-gtm-creative</code></li>
<li><code>data-gtm-id</code></li>
<li><code>data-gtm-name</code></li>
<li><code>data-gtm-position</code></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;promotionView&#39; event example</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The event --&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;promotionView&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- The item --&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackItem&quot;</span><span class="ot"> data-gtm-type=</span><span class="st">&quot;promotions&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-creative=</span><span class="st">&quot;Saldos&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-id=</span><span class="st">&quot;191202&quot;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-name=</span><span class="st">&quot;4xsaldojunio&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="ot">      data-gtm-position=</span><span class="st">&quot;Slider2a:Home&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="er">…</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&gt;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  …</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/div&gt;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h3 id="js-trackclick">.js-trackClick</h3>
<p>The JavaScript looks for the <code>js-trackClick</code> class to track user interactions. It then reads custom attributes included on the related DOM element to build the event data.</p>
<h3 id="data-gtm-track">data-gtm-track</h3>
<p>Events tracked through the attribute <code>data-gtm-track</code>:</p>
<ul>
<li><code>productClick</code></li>
<li><code>promotionClick</code></li>
</ul>
<p>All clickable elements within a ‘product’ or ‘promotion’ that you want to track should have the <code>js-trackClick</code> class and <code>data-gtm-track</code> attribute.</p>
<h2 id="event-types">Event Types</h2>
<h3 id="passive-event-tracking">‘Passive’ Event tracking</h3>
<p>‘Passive’ events are considered to be ones that fire without user interactions with the DOM, events such as viewing a product, visiting a product detail page or seeing a promotion for example.</p>
<p>These events rely on DOM mark up to trigger and typically trigger on page load or when child elements become visible.</p>
<h4 id="passive-events">Passive events</h4>
<ul>
<li><code>productImpression</code> - Tracked when products enter the viewport</li>
<li><code>promotionView</code> - Tracked when promotions enter the viewport</li>
<li><code>productDetail</code> - Tracked on page load (assuming data is provided)</li>
<li><code>checkout</code> - Tracked on page load (assuming data is provided)</li>
<li><code>purchase</code> - Tracked on page load (assuming data is provided)</li>
</ul>
<h3 id="active-event-tracking">‘Active’ Event tracking</h3>
<p>‘Active’ events are considered to be ones where a user interacts with elements on the page. Events like showing active interest in a product or adding an item to the cart would be considered ‘active’ events.</p>
<p>These events rely on user activity to trigger, <code>click</code> events typically, however this is not always the case.</p>
<h4 id="active-events">Active events</h4>
<ul>
<li><code>productClick</code> - Tracked when a user clicks a trigger element (before page load)</li>
<li><code>promotionClick</code> - Tracked when a user clicks a trigger element (before page load)</li>
<li><code>addToCart</code> - Special case, see note below</li>
<li><code>removeFromCart</code> - Special case, see note below</li>
</ul>
<h2 id="event-triggers">Event triggers</h2>
<h3 id="productimpression-promotionview">productImpression &amp; promotionView</h3>
<p><code>productImpression</code> and <code>promotionView</code> events are triggered when a product becomes visible within the viewport. The presence of a product on a page does not guarantee that a user sees it.</p>
<p>To combat this, <code>observables</code> have been used to update the dataLayer ONLY when DOM elements intersect the viewport.</p>
<p>There are two sets of required mark up for these events to trigger, a wrapper and at least one ‘product’.</p>
<h3 id="productdetail-checkout">productDetail &amp; checkout</h3>
<p><code>productDetail</code> and <code>checkout</code> events are triggered when a user lands on a page that has correctly configured <code>js-trackEvent</code> class, <code>data-gtm-event="…"</code> attribute and additional custom data-attribute properties. Remember that events are able to receive whatever parameters you like, so simply set up the attributes to match the desired event object data structure.</p>
<p><strong>JavaScript</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Desired javascript</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dataLayer<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">event</span><span class="op">:</span> checkout<span class="op">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventCategory</span><span class="op">:</span> <span class="st">&#39;EE Funnel&#39;</span><span class="op">,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventAction</span><span class="op">:</span> <span class="st">&#39;Step 3&#39;</span><span class="op">,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventLabel</span><span class="op">:</span> <span class="st">&#39;Payment&#39;</span><span class="op">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">journey</span><span class="op">:</span> <span class="st">&#39;New line with contract&#39;</span><span class="op">,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ecommerce</span><span class="op">:</span> {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    …</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><strong>HTML</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;checkout&quot;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ot">  data-gtm-event=</span><span class="st">&quot;&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ot">  data-gtm-event-category=</span><span class="st">&quot;EE Funnel&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="ot">  data-gtm-event-action=</span><span class="st">&quot;Step 3&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ot">  data-gtm-event-label=</span><span class="st">&quot;Payment&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="ot">  data-gtm-journey=</span><span class="st">&quot;New line with contract&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="er">…</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h3 id="purchase">purchase</h3>
<p>As with the previous example, the <code>purchase</code> event is triggered when a user lands on a page that has correctly configured <code>js-trackEvent</code> class, <code>data-gtm-event="…"</code> attribute and additional custom <code>data-attribute</code> properties; However, once a user has made a purchase and is on a “Thank you” page, it is not typical to present them with their order.</p>
<p>You do not need to render any <em>visible</em> DOM elements, it is only required that they are present. This can be achieved however you like, however in the example provided in purchase.html, empty <code>&lt;var&gt;</code> elements are used.</p>
<p><strong>JavaScript</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Desired javascript</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dataLayer<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">action</span><span class="op">:</span> <span class="st">&#39;transaction&#39;</span><span class="op">,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">affiliation</span><span class="op">:</span> <span class="st">&#39;Tigo Store&#39;</span><span class="op">,</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">event</span><span class="op">:</span> purchase<span class="op">,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;EE Funnel&#39;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">coupon</span><span class="op">:</span> <span class="st">&#39;TIGO20&#39;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">id</span><span class="op">:</span> <span class="st">&#39;abc123&#39;</span><span class="op">,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;Successful&#39;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">revenue</span><span class="op">:</span> <span class="st">&#39;123.45&#39;</span><span class="op">,</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">shipping</span><span class="op">:</span> <span class="st">&#39;4.99&#39;</span><span class="op">,</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tax</span><span class="op">:</span> <span class="st">&#39;3.00&#39;</span><span class="op">,</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ecommerce</span><span class="op">:</span> {</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    …</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><strong>HTML</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;purchase&#39; event example</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;purchase&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-category=</span><span class="st">&quot;EE Funnel&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-action=</span><span class="st">&quot;Transaction&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-label=</span><span class="st">&quot;Successful&quot;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-id=</span><span class="st">&quot;abc123&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-affiliation=</span><span class="st">&quot;Tigo Store&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-revenue=</span><span class="st">&quot;123.45&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-tax=</span><span class="st">&quot;3.00&quot;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-shipping=</span><span class="st">&quot;4.99&quot;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="ot">    data-gtm-coupon=</span><span class="st">&quot;TIGO20&quot;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="er">…</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>…</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<blockquote>
<p><strong>NOTE:</strong> A far more robust solution however, would be to have a separate piece of logic independent of the rendered DOM that fires the event itself. Since the purchase has already completed by the time the page loads, it is inefficient to render the data to the DOM, to then trigger a push. See <a href="https://developers.google.com/tag-manager/enhanced-ecommerce#purchases">Google’s documentation</a> for more information.</p>
</blockquote>
<h3 id="productclick-promotionclick">productClick &amp; promotionClick</h3>
<p>Click tracking is based on the container element/s that they are children of. Thay are expected to be the children of at least a <code>.js-trackItem</code> which is either a ‘product’ or ‘promotion’.</p>
<p>The only additional attribute required is <code>data-gtm-track</code> which houses the relevant event to send.</p>
<p><strong>HTML - Product</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;productClick&#39; event example</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The event --&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;item-list js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;productImpression&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- The item --&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;item js-trackItem&quot;</span><span class="ot"> data-gtm-type=</span><span class="st">&quot;products&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- The click trigger --&gt;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;js-trackClick&quot;</span><span class="ot"> data-gtm-track=</span><span class="st">&quot;productClick&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      Buy it now!</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/a&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/div&gt;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p><strong>HTML - Promotions</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;promotionClick&#39; event example</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">===================================</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The event --&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;item-list js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;promotionView&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- The item --&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;item js-trackItem&quot;</span><span class="ot"> data-gtm-type=</span><span class="st">&quot;promotions&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- The click trigger --&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;js-trackClick&quot;</span><span class="ot"> data-gtm-track=</span><span class="st">&quot;promotionClick&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      Buy it now!</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/a&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/div&gt;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h3 id="addtocart-removefromcart">addToCart &amp; removeFromCart</h3>
<p>The two cart events <code>addToCart</code> and <code>removeFromCart</code> have some rudimentary tracking created that requires an add/remove button and an input with a specific class. This is fine for basic applications however a more robust solution may be required.</p>
<p>Provided is a method to call on cart update that allows for finer control of the dataLayer event. See: <a href="#manually-triggering-a-cart-update-event">Manually triggering a cart update event</a></p>
<p><strong>HTML - Cart update</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">==============================================</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;addToCart&#39; or &#39;removeFromCart&#39; event example</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">==============================================</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The event --&gt;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackEvent&quot;</span><span class="ot"> data-gtm-event=</span><span class="st">&quot;productDetail&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- The item --&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;… js-trackItem&quot;</span><span class="ot"> data-gtm-type=</span><span class="st">&quot;products&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- Note the input element with a class of .js-trackQuantity --&gt;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;input</span><span class="ot"> class=</span><span class="st">&quot;js-trackQuantity&quot;</span><span class="ot"> type=</span><span class="st">&quot;number&quot;</span><span class="ot"> value=</span><span class="st">&quot;1&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- The click triggers --&gt;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;… js-trackClick&quot;</span><span class="ot"> data-gtm-track=</span><span class="st">&quot;addToCart&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      Add to cart</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/a&gt;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;… js-trackClick&quot;</span><span class="ot"> data-gtm-track=</span><span class="st">&quot;removeFromCart&quot;</span> <span class="er">…</span> <span class="kw">&gt;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>      Remove from cart</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/a&gt;</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/div&gt;</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h3 id="manually-triggering-a-cart-update-event">Manually triggering a cart update event</h3>
<p>It is possible to trigger a cart update event manually. This has been provided so that you aren’t reliant on the specific mark up of the DOM to update the dataLayer for the <code>addToCart</code> and <code>removeFromCart</code> events.</p>
<p>You may choose to fire this event when a user is in the checkout and removes an item from their cart for example.</p>
<p>To trigger this event, simply attach the function call <code>JF.triggerCartEvent()</code> to the remainder of your application’s cart update logic.</p>
<p>The triggerCartEvent function takes 3 parameters.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">// eventObj | an object for the first part of the dataLayer constructor.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> foo <span class="op">=</span> {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">event</span><span class="op">:</span> <span class="st">&#39;addToCart&#39;</span><span class="op">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventCategory</span><span class="op">:</span> <span class="st">&#39;EE Funnel&#39;</span><span class="op">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventAction</span><span class="op">:</span> <span class="st">&#39;Agregar al Carrito&#39;</span><span class="op">,</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">eventLabel</span><span class="op">:</span> <span class="st">&#39;Nueva Línea&#39;</span><span class="op">,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">journey</span><span class="op">:</span> <span class="st">&#39;Nueva línea con contrato&#39;</span><span class="op">,</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vigenciaPlan</span><span class="op">:</span> <span class="st">&#39;24 Meses&#39;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">// productObj | an object for the ecommerce part of the dataLayer constructor.</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bar <span class="op">=</span> {</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">brand</span><span class="op">:</span> <span class="st">&#39;Apple&#39;</span><span class="op">,</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Teléfonos&#39;</span><span class="op">,</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">id</span><span class="op">:</span> <span class="st">&#39;124&#39;</span><span class="op">,</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">list</span><span class="op">:</span> <span class="st">&#39;Detalle Producto&#39;</span><span class="op">,</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Iphone 2&#39;</span><span class="op">,</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">price</span><span class="op">:</span> <span class="st">&#39;44.95&#39;</span><span class="op">,</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="dt">quantity</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">variant</span><span class="op">:</span> <span class="st">&#39;White&#39;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">// updateType | a string that is either addToCart or removeFromCart</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> baz <span class="op">=</span> <span class="st">&#39;addToCart&#39;</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>JF<span class="op">.</span><span class="fu">triggerCartEvent</span>(foo<span class="op">,</span> bar<span class="op">,</span> baz)<span class="op">;</span></span></code></pre></div>
</body>
</html>
